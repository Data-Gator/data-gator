\doxysection{scheduler.\+hpp}
\hypertarget{scheduler_8hpp_source}{}\label{scheduler_8hpp_source}\index{include/scheduler.hpp@{include/scheduler.hpp}}
\mbox{\hyperlink{scheduler_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ }
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#ifndef\ SCHEDULER\_HPP}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#define\ SCHEDULER\_HPP}}
\DoxyCodeLine{00016\ }
\DoxyCodeLine{00017\ \textcolor{comment}{//\#include\ <setup\_util.hpp>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ <NimBLEDevice.h>}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ <Adafruit\_MAX1704X.h>}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ <OWMAdafruit\_ADS1015.h>}}
\DoxyCodeLine{00021\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{ble__util_8hpp}{ble\_util.hpp}}>}}
\DoxyCodeLine{00022\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{VWCSensor_8hpp}{VWCSensor.hpp}}>}}
\DoxyCodeLine{00023\ \textcolor{preprocessor}{\#include\ <Teros10.hpp>}}
\DoxyCodeLine{00024\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{Atlas__EZO-pH_8hpp}{Atlas\_EZO-\/pH.hpp}}>}}
\DoxyCodeLine{00025\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{Atlas__Gravity__pH_8hpp}{Atlas\_Gravity\_pH.hpp}}>}}
\DoxyCodeLine{00026\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{extern}\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{scheduler_8hpp_ac334200b5e3db6f6228d37cec3b03538}{maxlipo\_attached}};}
\DoxyCodeLine{00028\ \textcolor{keyword}{extern}\ Adafruit\_MAX17048\ \mbox{\hyperlink{scheduler_8hpp_a106fc9194d62779ffe942b866046530d}{maxlipo}};}
\DoxyCodeLine{00029\ \textcolor{keyword}{extern}\ \mbox{\hyperlink{classAdafruit__ADS1115}{Adafruit\_ADS1115}}\ \mbox{\hyperlink{scheduler_8hpp_a951ac31de71c2bf701a13e5f233fc6d8}{ads}};}
\DoxyCodeLine{00030\ }
\DoxyCodeLine{00031\ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ =\ -\/1;\ \textcolor{comment}{//\ times\ reset\ by\ WDT,\ one\ tick\ roughly\ equivalent\ to\ one\ minute}}
\DoxyCodeLine{00032\ }
\DoxyCodeLine{00044\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structplanner}{planner}}\{}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}}\ =\ -\/1;\ \ \ \ \ }
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structplanner_a8053e07d44e53920803b4c02dd48008c}{ht\_t0}}\ =\ -\/1;\ \ \ \ \ \ \ \ }
\DoxyCodeLine{00050\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structplanner_a6c06430db7ca522050ff7b27ea5ca487}{ota\_t0}}\ =\ -\/1;\ \ }
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{structplanner_a9fbe58c903893e4dc56d5ded1cb0bfd4}{tlm\_t0}}\ =\ -\/1;\ \ }
\DoxyCodeLine{00053\ \}\mbox{\hyperlink{structplanner}{planner}};}
\DoxyCodeLine{00054\ }
\DoxyCodeLine{00058\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{scheduler_8hpp_aa2c353c6e3271404cdf45ce4601951c7}{init\_nvs}}()\{}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ \ \ \textcolor{comment}{//\ NVS\ Setup}}
\DoxyCodeLine{00061\ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.begin(\textcolor{stringliteral}{"{}GatorState"{}},\ \mbox{\hyperlink{setup__util_8hpp_a308c6953759d216057ee734e42285f27}{RW\_MODE}});}
\DoxyCodeLine{00062\ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.isKey(\textcolor{stringliteral}{"{}reset\_count"{}}))\{\ \textcolor{comment}{//\ if\ key\ exists}}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ =\ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.getInt(\textcolor{stringliteral}{"{}reset\_count"{}});}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}++;}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\ Serial.printf(\textcolor{stringliteral}{"{}Reset\ Count\ =\ \%d\(\backslash\)n"{}},\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}});}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}reset\_count"{}},\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}});}
\DoxyCodeLine{00068\ }
\DoxyCodeLine{00069\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}}\ =\ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.getInt(\textcolor{stringliteral}{"{}analog\_t0"{}});}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a8053e07d44e53920803b4c02dd48008c}{ht\_t0}}\ =\ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.getInt(\textcolor{stringliteral}{"{}ht\_t0"{}});}
\DoxyCodeLine{00071\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a6c06430db7ca522050ff7b27ea5ca487}{ota\_t0}}\ =\ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.getInt(\textcolor{stringliteral}{"{}ota\_t0"{}});}
\DoxyCodeLine{00072\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a9fbe58c903893e4dc56d5ded1cb0bfd4}{tlm\_t0}}\ =\ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.getInt(\textcolor{stringliteral}{"{}tlm\_t0"{}});}
\DoxyCodeLine{00073\ }
\DoxyCodeLine{00074\ \ \ \ \ \}\textcolor{keywordflow}{else}\{\ \textcolor{comment}{//\ create\ the\ keys}}
\DoxyCodeLine{00075\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ =\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}}\ =\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a8053e07d44e53920803b4c02dd48008c}{ht\_t0}}\ =\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a6c06430db7ca522050ff7b27ea5ca487}{ota\_t0}}\ =\ 1;}
\DoxyCodeLine{00076\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\ Serial.printf(\textcolor{stringliteral}{"{}Reset\ Count\ =\ \%d\(\backslash\)n"{}},\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}});}
\DoxyCodeLine{00077\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}reset\_count"{}},\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}});\ \ \ }
\DoxyCodeLine{00078\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}analog\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}});}
\DoxyCodeLine{00079\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}ht\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a8053e07d44e53920803b4c02dd48008c}{ht\_t0}});}
\DoxyCodeLine{00080\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}ota\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a6c06430db7ca522050ff7b27ea5ca487}{ota\_t0}});}
\DoxyCodeLine{00081\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}tlm\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a9fbe58c903893e4dc56d5ded1cb0bfd4}{tlm\_t0}});}
\DoxyCodeLine{00082\ }
\DoxyCodeLine{00083\ \ \ \ \ \}}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \}}
\DoxyCodeLine{00086\ }
\DoxyCodeLine{00094\ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{scheduler_8hpp_acde0b5aea233a35b69ff211f55208c6b}{task\_is\_scheduled}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}})\{}
\DoxyCodeLine{00095\ \ \ \ \ \textcolor{keywordtype}{bool}\ run\_vwc\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ -\/\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}}\ >=\ \mbox{\hyperlink{config_8hpp_a63929664348237323cf24eda9d046748}{VWC\_FREQ}};}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordtype}{bool}\ run\_ht\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ -\/\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a8053e07d44e53920803b4c02dd48008c}{ht\_t0}}\ >=\ \mbox{\hyperlink{config_8hpp_ab8f6d4487aad03d548ccaba7645f7722}{HT\_FREQ}};}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordtype}{bool}\ run\_ota\_update\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ -\/\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a6c06430db7ca522050ff7b27ea5ca487}{ota\_t0}}\ >=\ \mbox{\hyperlink{config_8hpp_a5420655b6c292f8b3999b35374ff686a}{OTA\_FREQ}};}
\DoxyCodeLine{00098\ \ \ \ \ \textcolor{keywordtype}{bool}\ run\_tlm\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ -\/\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a9fbe58c903893e4dc56d5ded1cb0bfd4}{tlm\_t0}}\ >=\ \mbox{\hyperlink{config_8hpp_a4665514bc689b72073e4f94e00e0cb1e}{TLM\_FREQ}};}
\DoxyCodeLine{00099\ }
\DoxyCodeLine{00100\ \ \ \ \ \textcolor{keywordflow}{if}(\ run\_vwc\ ||\ run\_ht\ ||\ run\_ota\_update\ ||\ run\_tlm)\{}
\DoxyCodeLine{00101\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ start\ WIFI}}
\DoxyCodeLine{00102\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00103\ \ \ \ \ \}\textcolor{keywordflow}{else}\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00104\ }
\DoxyCodeLine{00105\ \}}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00110\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{scheduler_8hpp_a2ce5745ffb225d3a8167ba1970e3b777}{ReadHT}}()\{}
\DoxyCodeLine{00111\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\ Serial.println(\textcolor{stringliteral}{"{}[HT]"{}});}
\DoxyCodeLine{00112\ \ \ \ \ NimBLEScan*\ scanner\ =\ NimBLEDevice::getScan();}
\DoxyCodeLine{00113\ \ \ \ \ scanner-\/>setAdvertisedDeviceCallbacks(\textcolor{keyword}{new}\ \mbox{\hyperlink{classScanCallbacks}{ScanCallbacks}}());}
\DoxyCodeLine{00114\ \ \ \ \ scanner-\/>setActiveScan(\textcolor{keyword}{true});\ \ \ \textcolor{comment}{//\ retrieve\ results\ from\ all\ scanned\ devices}}
\DoxyCodeLine{00115\ \ \ \ \ scanner-\/>setInterval(100);\ \ \ \ \ \ \textcolor{comment}{//\ time\ between\ scans??}}
\DoxyCodeLine{00116\ \ \ \ \ scanner-\/>setWindow(99);\ \ \ \ \ \textcolor{comment}{//\ less\ than\ or\ equal\ to\ setInterval,\ is\ how\ long\ to\ scan\ for}}
\DoxyCodeLine{00117\ \ \ \ \ \textcolor{comment}{//scanner-\/>start(5,\ true);}}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00119\ \ \ \ \ \textcolor{keywordtype}{int}\ scanTime\ =\ 10;\ \textcolor{comment}{//\ in\ seconds}}
\DoxyCodeLine{00120\ }
\DoxyCodeLine{00121\ \ \ \ \ BLEScanResults\ res\ =\ scanner-\/>start(scanTime,\ \textcolor{keyword}{false});}
\DoxyCodeLine{00122\ \ \ \ \ scanner-\/>clearResults();}
\DoxyCodeLine{00123\ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00128\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{scheduler_8hpp_ae6b4c9f02d24e6345a8244b129cb4bce}{ReadWired}}()\{}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\ Serial.println(\textcolor{stringliteral}{"{}[VWC/WIRED\ SENSORS]\ queueing\ data"{}});}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ \ \ \textcolor{comment}{//\ turn\ on\ power\ to\ sensors}}
\DoxyCodeLine{00133\ \ \ \ \ digitalWrite(\mbox{\hyperlink{pinout_8hpp_ab241a96e494c05c7b5288a549f6c0c01}{PWR\_EN}},\ HIGH);}
\DoxyCodeLine{00134\ \ \ \ \ delay(10000);}
\DoxyCodeLine{00135\ }
\DoxyCodeLine{00136\ \ \ \ \ \textcolor{comment}{//\ initialize\ sensor\ readers}}
\DoxyCodeLine{00137\ \ \ \ \ \mbox{\hyperlink{classVWCSensor}{VWCSensor}}*\ vwc\_converter\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classTeros10}{Teros10}}();}
\DoxyCodeLine{00138\ \ \ \ \ \mbox{\hyperlink{classpHSensor}{pHSensor}}*\ pH\_converter\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAtlasGravitypH}{AtlasGravitypH}}();}
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{classAtlasEZOpH}{AtlasEZOpH}}*\ ezopH\_converter\ =\ \textcolor{keyword}{new}\ \mbox{\hyperlink{classAtlasEZOpH}{AtlasEZOpH}}();}
\DoxyCodeLine{00140\ }
\DoxyCodeLine{00141\ \ \ \ \ \mbox{\hyperlink{classMQTTMailer}{MQTTMailer}}\ instance\ =\ MQTTMailer::getInstance();}
\DoxyCodeLine{00142\ \ \ \ \ \textcolor{comment}{//\ get\ the\ MAC\ address}}
\DoxyCodeLine{00143\ \ \ \ \ std::string\ mac\_str(WiFi.macAddress().c\_str());}
\DoxyCodeLine{00144\ }
\DoxyCodeLine{00145\ \ \ \ \ }
\DoxyCodeLine{00146\ \ \ \ \ \textcolor{keywordtype}{int}\ raw\_analog[4];}
\DoxyCodeLine{00147\ \ \ \ \ \textcolor{keywordtype}{double}\ voltage[4];}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00149\ \ \ \ \ \textcolor{comment}{//\ read\ voltage\ at\ analog\ ports}}
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{comment}{//\ SHALLOW}}
\DoxyCodeLine{00151\ \ \ \ \ raw\_analog[0]\ =\ \mbox{\hyperlink{scheduler_8hpp_a951ac31de71c2bf701a13e5f233fc6d8}{ads}}.\mbox{\hyperlink{classAdafruit__ADS1015_a40f38b9e1f3ec397c0670dd632510235}{readADC\_SingleEnded}}(1);}
\DoxyCodeLine{00152\ \ \ \ \ voltage[0]\ =\ raw\_analog[0]\ *\ 0.0001875;}
\DoxyCodeLine{00153\ \ \ \ \ \textcolor{comment}{//\ MIDDLE}}
\DoxyCodeLine{00154\ \ \ \ \ raw\_analog[1]\ =\ \mbox{\hyperlink{scheduler_8hpp_a951ac31de71c2bf701a13e5f233fc6d8}{ads}}.\mbox{\hyperlink{classAdafruit__ADS1015_a40f38b9e1f3ec397c0670dd632510235}{readADC\_SingleEnded}}(2);}
\DoxyCodeLine{00155\ \ \ \ \ voltage[1]\ =\ raw\_analog[1]\ *\ 0.0001875;}
\DoxyCodeLine{00156\ \ \ \ \ \textcolor{comment}{//\ DEEP}}
\DoxyCodeLine{00157\ \ \ \ \ raw\_analog[2]\ =\ \mbox{\hyperlink{scheduler_8hpp_a951ac31de71c2bf701a13e5f233fc6d8}{ads}}.\mbox{\hyperlink{classAdafruit__ADS1015_a40f38b9e1f3ec397c0670dd632510235}{readADC\_SingleEnded}}(3);}
\DoxyCodeLine{00158\ \ \ \ \ voltage[2]\ =\ raw\_analog[2]\ *\ 0.0001875;}
\DoxyCodeLine{00159\ \ \ \ \ \textcolor{comment}{//\ ANALOG/pH}}
\DoxyCodeLine{00160\ \ \ \ \ raw\_analog[3]\ =\ \mbox{\hyperlink{scheduler_8hpp_a951ac31de71c2bf701a13e5f233fc6d8}{ads}}.\mbox{\hyperlink{classAdafruit__ADS1015_a40f38b9e1f3ec397c0670dd632510235}{readADC\_SingleEnded}}(0);}
\DoxyCodeLine{00161\ \ \ \ \ voltage[3]\ =\ raw\_analog[3]\ *\ 0.0001875;}
\DoxyCodeLine{00162\ }
\DoxyCodeLine{00163\ \ \ \ \ \textcolor{comment}{//\ read\ I2C\ sensors}}
\DoxyCodeLine{00164\ \ \ \ \ \textcolor{keywordtype}{char}\ pH\_normal[32];}
\DoxyCodeLine{00165\ \ \ \ \ \textcolor{keywordtype}{char}\ pH\_shallow[32];}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordtype}{char}\ pH\_middle[32];}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordtype}{char}\ pH\_deep[32];}
\DoxyCodeLine{00168\ \ \ \ \ \textcolor{comment}{//\ NORMAL}}
\DoxyCodeLine{00169\ \ \ \ \ \textcolor{keywordflow}{if}(ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_aba8042f8d8a408258d4685248ca75afd}{sensor\_at\_address}}(\mbox{\hyperlink{Atlas__EZO-pH_8hpp_ad68841b3716d94d4c59f8bff9449cc44}{EZO\_I2C\_ADDR}}))\{}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ strcpy(pH\_normal,\ ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_adeb395ac5b1a3348aeb3023f53be82a7}{getpH\_str}}(\mbox{\hyperlink{Atlas__EZO-pH_8hpp_ad68841b3716d94d4c59f8bff9449cc44}{EZO\_I2C\_ADDR}}));}
\DoxyCodeLine{00171\ \ \ \ \ \ \ \ \ ezopH\_converter-\/>clear\_pH\_str();}
\DoxyCodeLine{00172\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ build\ pH\ mqtt\ message}}
\DoxyCodeLine{00173\ \ \ \ \ \ \ \ \ std::string\ topic\ =\ ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_aea3c9661bb25197154340c37a8a22f8d}{getSensorType}}()\ +\ \textcolor{stringliteral}{"{}/pH/normal/"{}}\ +\ mac\_str;}
\DoxyCodeLine{00174\ \ \ \ \ \ \ \ \ \textcolor{comment}{//std::string\ msg\ =\ "{}\{\(\backslash\)"{}MAC\(\backslash\)"{}:\ \(\backslash\)"{}"{}\ +\ mac\_str\ +\ "{}\(\backslash\)"{},"{}\ +\ pH\_converter-\/>toJSON(voltage[3])\ +\ "{}\}"{};}}
\DoxyCodeLine{00175\ \ \ \ \ \ \ \ \ std::string\ msg\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}MAC\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ +\ mac\_str\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{},\ \(\backslash\)"{}PH\(\backslash\)"{}:"{}}\ +\ pH\_normal\ +\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ \textcolor{comment}{//instance.mailMessage(\&mqtt\_client,\ topic,\ msg);}}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8hpp_a2799093145858620308ff4421e6a1ea3}{log\_data}}(topic,\ msg);}
\DoxyCodeLine{00178\ \ \ \ \ }
\DoxyCodeLine{00179\ \ \ \ \ \}\textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\{}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}\(\backslash\)tno\ pH\ at\ addr\ 99"{}});}
\DoxyCodeLine{00181\ \ \ \ \ \}}
\DoxyCodeLine{00182\ \ \ \ \ \textcolor{comment}{//\ SHALLOW}}
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keywordflow}{if}(ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_aba8042f8d8a408258d4685248ca75afd}{sensor\_at\_address}}(\mbox{\hyperlink{Atlas__EZO-pH_8hpp_a242ad1ab2cf28ec4377609b9f0fa651a}{EZO\_I2C\_SHALLOW\_ADDR}}))\{}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \ \ strcpy(pH\_shallow,\ ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_adeb395ac5b1a3348aeb3023f53be82a7}{getpH\_str}}(\mbox{\hyperlink{Atlas__EZO-pH_8hpp_a242ad1ab2cf28ec4377609b9f0fa651a}{EZO\_I2C\_SHALLOW\_ADDR}}));}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ ezopH\_converter-\/>clear\_pH\_str();}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ build\ pH\ mqtt\ message}}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ std::string\ topic\ =\ ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_aea3c9661bb25197154340c37a8a22f8d}{getSensorType}}()\ +\ \textcolor{stringliteral}{"{}/pH/shallow/"{}}\ +\ mac\_str;}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \textcolor{comment}{//std::string\ msg\ =\ "{}\{\(\backslash\)"{}MAC\(\backslash\)"{}:\ \(\backslash\)"{}"{}\ +\ mac\_str\ +\ "{}\(\backslash\)"{},"{}\ +\ pH\_converter-\/>toJSON(voltage[3])\ +\ "{}\}"{};}}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ std::string\ msg\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}MAC\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ +\ mac\_str\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{},\ \(\backslash\)"{}PH\(\backslash\)"{}:"{}}\ +\ pH\_shallow\ +\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{00190\ \ \ \ \ \ \ \ \ \textcolor{comment}{//instance.mailMessage(\&mqtt\_client,\ topic,\ msg);}}
\DoxyCodeLine{00191\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8hpp_a2799093145858620308ff4421e6a1ea3}{log\_data}}(topic,\ msg);}
\DoxyCodeLine{00192\ \ \ \ \ }
\DoxyCodeLine{00193\ \ \ \ \ \}\textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\{}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}\(\backslash\)tno\ pH\ at\ addr\ shallow"{}});}
\DoxyCodeLine{00195\ \ \ \ \ \}}
\DoxyCodeLine{00196\ \ \ \ \ \textcolor{comment}{//\ MIDDLE}}
\DoxyCodeLine{00197\ \ \ \ \ \textcolor{keywordflow}{if}(ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_aba8042f8d8a408258d4685248ca75afd}{sensor\_at\_address}}(\mbox{\hyperlink{Atlas__EZO-pH_8hpp_a38810c17da6ac2f88f092f267c6709e5}{EZO\_I2C\_MIDDLE\_ADDR}}))\{}
\DoxyCodeLine{00198\ \ \ \ \ \ \ \ \ strcpy(pH\_middle,\ ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_adeb395ac5b1a3348aeb3023f53be82a7}{getpH\_str}}(\mbox{\hyperlink{Atlas__EZO-pH_8hpp_a38810c17da6ac2f88f092f267c6709e5}{EZO\_I2C\_MIDDLE\_ADDR}}));}
\DoxyCodeLine{00199\ \ \ \ \ \ \ \ \ ezopH\_converter-\/>clear\_pH\_str();}
\DoxyCodeLine{00200\ \ \ \ \ \ \ \ \ std::string\ topic\ =\ ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_aea3c9661bb25197154340c37a8a22f8d}{getSensorType}}()\ +\ \textcolor{stringliteral}{"{}/pH/middle/"{}}\ +\ mac\_str;}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \ \ \textcolor{comment}{//std::string\ msg\ =\ "{}\{\(\backslash\)"{}MAC\(\backslash\)"{}:\ \(\backslash\)"{}"{}\ +\ mac\_str\ +\ "{}\(\backslash\)"{},"{}\ +\ pH\_converter-\/>toJSON(voltage[3])\ +\ "{}\}"{};}}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \ \ std::string\ msg\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}MAC\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ +\ mac\_str\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{},\ \(\backslash\)"{}PH\(\backslash\)"{}:"{}}\ +\ pH\_middle\ +\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \ \ \textcolor{comment}{//instance.mailMessage(\&mqtt\_client,\ topic,\ msg);}}
\DoxyCodeLine{00204\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8hpp_a2799093145858620308ff4421e6a1ea3}{log\_data}}(topic,\ msg);}
\DoxyCodeLine{00205\ \ \ \ \ }
\DoxyCodeLine{00206\ \ \ \ \ \}\textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\{}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}\(\backslash\)tno\ pH\ at\ addr\ middle"{}});}
\DoxyCodeLine{00208\ \ \ \ \ \}}
\DoxyCodeLine{00209\ \ \ \ \ \textcolor{comment}{//\ DEEP}}
\DoxyCodeLine{00210\ \ \ \ \ \textcolor{keywordflow}{if}(ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_aba8042f8d8a408258d4685248ca75afd}{sensor\_at\_address}}(\mbox{\hyperlink{Atlas__EZO-pH_8hpp_ae31f510f2f33c5d639891d3aaf9dd563}{EZO\_I2C\_DEEP\_ADDR}}))\{}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ strcpy(pH\_deep,\ ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_adeb395ac5b1a3348aeb3023f53be82a7}{getpH\_str}}(\mbox{\hyperlink{Atlas__EZO-pH_8hpp_ae31f510f2f33c5d639891d3aaf9dd563}{EZO\_I2C\_DEEP\_ADDR}}));}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ ezopH\_converter-\/>clear\_pH\_str();}
\DoxyCodeLine{00213\ \ \ \ \ \ \ \ \ std::string\ topic\ =\ ezopH\_converter-\/>\mbox{\hyperlink{classAtlasEZOpH_aea3c9661bb25197154340c37a8a22f8d}{getSensorType}}()\ +\ \textcolor{stringliteral}{"{}/pH/deep/"{}}\ +\ mac\_str;}
\DoxyCodeLine{00214\ \ \ \ \ \ \ \ \ \textcolor{comment}{//std::string\ msg\ =\ "{}\{\(\backslash\)"{}MAC\(\backslash\)"{}:\ \(\backslash\)"{}"{}\ +\ mac\_str\ +\ "{}\(\backslash\)"{},"{}\ +\ pH\_converter-\/>toJSON(voltage[3])\ +\ "{}\}"{};}}
\DoxyCodeLine{00215\ \ \ \ \ \ \ \ \ std::string\ msg\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}MAC\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ +\ mac\_str\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{},\ \(\backslash\)"{}PH\(\backslash\)"{}:"{}}\ +\ pH\_deep\ +\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{00216\ \ \ \ \ \ \ \ \ \textcolor{comment}{//instance.mailMessage(\&mqtt\_client,\ topic,\ msg);}}
\DoxyCodeLine{00217\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8hpp_a2799093145858620308ff4421e6a1ea3}{log\_data}}(topic,\ msg);}
\DoxyCodeLine{00218\ \ \ \ \ }
\DoxyCodeLine{00219\ \ \ \ \ \}\textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\{}
\DoxyCodeLine{00220\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}\(\backslash\)tno\ pH\ at\ addr\ deep"{}});}
\DoxyCodeLine{00221\ \ \ \ \ \}}
\DoxyCodeLine{00222\ }
\DoxyCodeLine{00223\ \ \ \ \ free(pH\_converter);}
\DoxyCodeLine{00224\ \ \ \ \ }
\DoxyCodeLine{00225\ \ \ \ \ \textcolor{comment}{//\ turn\ off\ power\ to\ sensors}}
\DoxyCodeLine{00226\ \ \ \ \ digitalWrite(\mbox{\hyperlink{pinout_8hpp_ab241a96e494c05c7b5288a549f6c0c01}{PWR\_EN}},\ LOW);}
\DoxyCodeLine{00227\ }
\DoxyCodeLine{00228\ \ \ \ \ \textcolor{comment}{//\ build\ VWC\ mqtt\ message}}
\DoxyCodeLine{00229\ \ \ \ \ std::string\ brand\ =\ vwc\_converter-\/>\mbox{\hyperlink{classVWCSensor_a92a5fd826886da4f7961193daeaaf82e}{getSensorType}}();}
\DoxyCodeLine{00230\ }
\DoxyCodeLine{00231\ \ \ \ \ \textcolor{keywordflow}{if}(WiFi.status()\ ==\ WL\_CONNECTED\ \&\&\ !\mbox{\hyperlink{update_8cpp_a965861de1a367ef4c2b467de34de2683}{mqtt\_client}}.connected())\{}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\ Serial.println(\textcolor{stringliteral}{"{}\(\backslash\)t-\/>\ not\ connected"{}});}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ instance.\mbox{\hyperlink{classMQTTMailer_af60393c05c00cebf768f3f3ed16b02bd}{reconnect}}(\mbox{\hyperlink{update_8cpp_a965861de1a367ef4c2b467de34de2683}{mqtt\_client}});}
\DoxyCodeLine{00234\ \ \ \ \ \}}
\DoxyCodeLine{00235\ }
\DoxyCodeLine{00236\ \ \ \ \ \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int}\ i\ =\ 0;\ i\ <\ 3;\ i++)\{}
\DoxyCodeLine{00237\ }
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ std::string\ depth\ =\ \textcolor{stringliteral}{"{}"{}};}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{switch}(i)\{}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 0:}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ depth\ =\ \textcolor{stringliteral}{"{}shallow"{}};}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 1:}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ depth\ =\ \textcolor{stringliteral}{"{}middle"{}};}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{case}\ 2:}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ depth\ =\ \textcolor{stringliteral}{"{}deep"{}};}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ std::string\ topic\ =\ brand\ +\ \textcolor{stringliteral}{"{}/"{}}\ +\ std::to\_string(i)\ +\ std::string(\textcolor{stringliteral}{"{}\_"{}})\ +\ depth\ +\ std::string(\textcolor{stringliteral}{"{}/"{}})\ +\ mac\_str;}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ std::string\ msg\ =\ \textcolor{stringliteral}{"{}\{\(\backslash\)"{}MAC\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ +\ mac\_str\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{},\ \(\backslash\)"{}DEPTH\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ +\ depth\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{},\ "{}}\ +\ vwc\_converter-\/>\mbox{\hyperlink{classVWCSensor_a26734d5d7a7dfc050e16fc38c4c49f2d}{toJSON}}(voltage[i])\ +\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \textcolor{comment}{//instance.mailMessage(\&mqtt\_client,\ topic,\ msg);}}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{logger_8hpp_a2799093145858620308ff4421e6a1ea3}{log\_data}}(topic,\ msg);}
\DoxyCodeLine{00255\ \ \ \ \ \}}
\DoxyCodeLine{00256\ \ \ \ \ free(vwc\_converter);}
\DoxyCodeLine{00257\ \}}
\DoxyCodeLine{00258\ }
\DoxyCodeLine{00262\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{scheduler_8hpp_a2137cbb31cc2a84abc73c9420ea062f1}{OTAUpdate}}()\{}
\DoxyCodeLine{00263\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{src_2main_8cpp_a45a3fd1220b5c8c7557fb18db8c20e50}{USB\_DEBUG}})\ Serial.println(\textcolor{stringliteral}{"{}[OTA]\ ran"{}});}
\DoxyCodeLine{00264\ \ \ \ \ \mbox{\hyperlink{update_8cpp_ac73e1e13b3305f391b3319037813e9b0}{attempt\_update}}();}
\DoxyCodeLine{00265\ \}}
\DoxyCodeLine{00266\ }
\DoxyCodeLine{00270\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{scheduler_8hpp_a463da0b6a8745959b8d837ae6ee2c6f5}{PatWDT}}()\{}
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{src_2main_8cpp_a45a3fd1220b5c8c7557fb18db8c20e50}{USB\_DEBUG}})\ Serial.println(\textcolor{stringliteral}{"{}[WDT]\ ran"{}});}
\DoxyCodeLine{00272\ \ \ \ \ digitalWrite(\mbox{\hyperlink{pinout_8hpp_abe6b865c045f3e7c6892ef4f15ff5779}{DONE}},\ HIGH);}
\DoxyCodeLine{00273\ \ \ \ \ vTaskDelay(pdMS\_TO\_TICKS(10));}
\DoxyCodeLine{00274\ \ \ \ \ digitalWrite(\mbox{\hyperlink{pinout_8hpp_abe6b865c045f3e7c6892ef4f15ff5779}{DONE}},\ LOW);}
\DoxyCodeLine{00275\ \}}
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00280\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{scheduler_8hpp_af6136b721c9ebd2c70157f07e7061f96}{SendTLM}}()\{}
\DoxyCodeLine{00281\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\{}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ Serial.println(\textcolor{stringliteral}{"{}[TLM]\ queueing\ data"{}});}
\DoxyCodeLine{00283\ \ \ \ \ \}}
\DoxyCodeLine{00284\ }
\DoxyCodeLine{00285\ \ \ \ \ digitalWrite(\mbox{\hyperlink{pinout_8hpp_ab241a96e494c05c7b5288a549f6c0c01}{PWR\_EN}},\ HIGH);}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \ \ \mbox{\hyperlink{classMQTTMailer}{MQTTMailer}}\ instance\ =\ MQTTMailer::getInstance();}
\DoxyCodeLine{00288\ }
\DoxyCodeLine{00289\ \ \ \ \ \textcolor{keywordflow}{if}(WiFi.status()\ ==\ WL\_CONNECTED\ \&\&\ !\mbox{\hyperlink{update_8cpp_a965861de1a367ef4c2b467de34de2683}{mqtt\_client}}.connected())\{}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{src_2main_8cpp_a45a3fd1220b5c8c7557fb18db8c20e50}{USB\_DEBUG}})\ Serial.println(\textcolor{stringliteral}{"{}\(\backslash\)t-\/>\ not\ connected"{}});}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \ \ instance.\mbox{\hyperlink{classMQTTMailer_af60393c05c00cebf768f3f3ed16b02bd}{reconnect}}(\mbox{\hyperlink{update_8cpp_a965861de1a367ef4c2b467de34de2683}{mqtt\_client}});}
\DoxyCodeLine{00292\ \ \ \ \ \}}
\DoxyCodeLine{00293\ }
\DoxyCodeLine{00294\ \ \ \ \ std::string\ fw\_version\ =\ \textcolor{stringliteral}{"{}V"{}}\ +\ std::to\_string(VERSION\_MAJOR)\ +\ \textcolor{stringliteral}{"{}."{}}\ +\ std::to\_string(VERSION\_MINOR)\ +\ \textcolor{stringliteral}{"{}."{}}\ +\ std::to\_string(VERSION\_PATCH);}
\DoxyCodeLine{00295\ \ \ \ \ std::string\ topic\ =\ \textcolor{stringliteral}{"{}datagator/tlm/"{}}\ +\ std::string(WiFi.macAddress().c\_str());}
\DoxyCodeLine{00296\ \ \ \ \ std::string\ msg\ =\ \textcolor{stringliteral}{"{}\{\ \(\backslash\)"{}MAC\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ +\ std::string(WiFi.macAddress().c\_str())\ +\ }
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)"{},\ \(\backslash\)"{}FIRMWARE\_VERSION\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ +\ fw\_version\ +\ }
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}\(\backslash\)"{},\ \(\backslash\)"{}RSSI\(\backslash\)"{}:\ "{}}\ +\ std::to\_string(WiFi.RSSI())\ +\ }
\DoxyCodeLine{00299\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{},\ \(\backslash\)"{}BSSID\(\backslash\)"{}:\ \(\backslash\)"{}"{}}\ +\ WiFi.BSSIDstr().c\_str()\ +\ \textcolor{stringliteral}{"{}\(\backslash\)"{}"{}};}
\DoxyCodeLine{00300\ }
\DoxyCodeLine{00301\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{scheduler_8hpp_ac334200b5e3db6f6228d37cec3b03538}{maxlipo\_attached}})\{}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ msg\ =\ msg\ +\ \textcolor{stringliteral}{"{},\ \(\backslash\)"{}BATT\_VOLTAGE\(\backslash\)"{}:\ "{}}\ +\ std::to\_string(\mbox{\hyperlink{scheduler_8hpp_a106fc9194d62779ffe942b866046530d}{maxlipo}}.cellVoltage())\ +}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{},\ \(\backslash\)"{}BATT\_PERCENTAGE\(\backslash\)"{}:\ "{}}\ +\ std::to\_string(\mbox{\hyperlink{scheduler_8hpp_a106fc9194d62779ffe942b866046530d}{maxlipo}}.cellPercent())\ +\ \textcolor{stringliteral}{"{}\}"{}};}
\DoxyCodeLine{00304\ \ \ \ \ \}\textcolor{keywordflow}{else}\{}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ msg\ =\ msg\ +\ \textcolor{stringliteral}{"{},\ \(\backslash\)"{}BATT\_VOLTAGE\(\backslash\)"{}:\ -\/1"{}}\ +}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{},\ \(\backslash\)"{}BATT\_PERCENTAGE\(\backslash\)"{}:\ -\/1\}"{}};}
\DoxyCodeLine{00307\ \ \ \ \ \}}
\DoxyCodeLine{00308\ \ \ \ \ }
\DoxyCodeLine{00309\ \ \ \ \ digitalWrite(\mbox{\hyperlink{pinout_8hpp_ab241a96e494c05c7b5288a549f6c0c01}{PWR\_EN}},\ LOW);}
\DoxyCodeLine{00310\ \ \ \ \ \textcolor{comment}{//instance.mailMessage(\&mqtt\_client,\ topic,\ msg);}}
\DoxyCodeLine{00311\ \ \ \ \ \mbox{\hyperlink{logger_8hpp_a2799093145858620308ff4421e6a1ea3}{log\_data}}(topic,\ msg);}
\DoxyCodeLine{00312\ \}}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ }
\DoxyCodeLine{00320\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{scheduler_8hpp_a40655c198dfde88ff025be197f8bc0ea}{Scheduler}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}})\{}
\DoxyCodeLine{00321\ }
\DoxyCodeLine{00322\ \ \ \ \ \textcolor{comment}{//\ bounds\ checking\ -\/>\ error\ msgs}}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count\ <\ 0\ ||\ reset\_count\ >}}\ \mbox{\hyperlink{config_8hpp_ae14eaaed1fe7cdf491da54a714c426b3}{MAX\_COUNT}}\ ||\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}}\ >\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}})\{}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{config_8hpp_ad72dbcf6d0153db1b8d8a58001feed83}{DEBUG}})\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{Serial}}.println(\textcolor{stringliteral}{"{}[ERROR]\ over\ ran\ max\ reset\ count\ without\ reseting\ count,\ check\ if\ variable\ is\ being\ reset\ or\ if\ tasks\ are\ not\ completing"{}});}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ \textcolor{comment}{//Serial.printf("{}\(\backslash\)tPlanner\ \{\ read\ analog\ [\%d],\ read\ ht\ [\%d],\ published\ MQTT\ [\%d]\ \}\(\backslash\)n"{},\ planner.readAnalog,\ planner.readHT,\ planner.publishedMQTT);}}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ =\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}}\ =\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a8053e07d44e53920803b4c02dd48008c}{ht\_t0}}\ =\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a6c06430db7ca522050ff7b27ea5ca487}{ota\_t0}}\ =\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a9fbe58c903893e4dc56d5ded1cb0bfd4}{tlm\_t0}}\ =\ 1;}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}reset\_count"{}},\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}});\ \ \ }
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}analog\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}});}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}ht\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a8053e07d44e53920803b4c02dd48008c}{ht\_t0}});}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}ota\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a6c06430db7ca522050ff7b27ea5ca487}{ota\_t0}});}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}tlm\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a9fbe58c903893e4dc56d5ded1cb0bfd4}{tlm\_t0}});}
\DoxyCodeLine{00332\ \ \ \ \ \}}
\DoxyCodeLine{00333\ }
\DoxyCodeLine{00334\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{run\_vwc}}\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ -\/\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}}\ >=\ \mbox{\hyperlink{config_8hpp_a63929664348237323cf24eda9d046748}{VWC\_FREQ}};}
\DoxyCodeLine{00335\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{run\_ht}}\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ -\/\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a8053e07d44e53920803b4c02dd48008c}{ht\_t0}}\ >=\ \mbox{\hyperlink{config_8hpp_ab8f6d4487aad03d548ccaba7645f7722}{HT\_FREQ}};}
\DoxyCodeLine{00336\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{run\_ota\_update}}\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ -\/\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a6c06430db7ca522050ff7b27ea5ca487}{ota\_t0}}\ >=\ \mbox{\hyperlink{config_8hpp_a5420655b6c292f8b3999b35374ff686a}{OTA\_FREQ}};}
\DoxyCodeLine{00337\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{run\_tlm}}\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}}\ -\/\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a9fbe58c903893e4dc56d5ded1cb0bfd4}{tlm\_t0}}\ >=\ \mbox{\hyperlink{config_8hpp_a4665514bc689b72073e4f94e00e0cb1e}{TLM\_FREQ}};}
\DoxyCodeLine{00338\ }
\DoxyCodeLine{00339\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{run\_vwc}})\{}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{scheduler_8hpp_ae6b4c9f02d24e6345a8244b129cb4bce}{ReadWired}}();}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}}\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}};}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}analog\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_aec15be434a9427f8071b39d9819b6262}{analog\_t0}});}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{update_8cpp_a965861de1a367ef4c2b467de34de2683}{mqtt\_client}}.loop();}
\DoxyCodeLine{00344\ \ \ \ \ \}}
\DoxyCodeLine{00345\ }
\DoxyCodeLine{00346\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{run\_ht}})\{}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{scheduler_8hpp_a2ce5745ffb225d3a8167ba1970e3b777}{ReadHT}}();}
\DoxyCodeLine{00348\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a8053e07d44e53920803b4c02dd48008c}{ht\_t0}}\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}};}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}ht\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a8053e07d44e53920803b4c02dd48008c}{ht\_t0}});}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Publish\ happens\ in\ callback\ function}}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{update_8cpp_a965861de1a367ef4c2b467de34de2683}{mqtt\_client}}.loop();}
\DoxyCodeLine{00352\ \ \ \ \ \}}
\DoxyCodeLine{00353\ }
\DoxyCodeLine{00354\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{run\_ota\_update}})\{}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a6c06430db7ca522050ff7b27ea5ca487}{ota\_t0}}\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}};}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}ota\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a6c06430db7ca522050ff7b27ea5ca487}{ota\_t0}});}
\DoxyCodeLine{00357\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{scheduler_8hpp_a2137cbb31cc2a84abc73c9420ea062f1}{OTAUpdate}}();}
\DoxyCodeLine{00358\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{update_8cpp_a965861de1a367ef4c2b467de34de2683}{mqtt\_client}}.loop();}
\DoxyCodeLine{00359\ \ \ \ \ \}}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{run\_tlm}})\{}
\DoxyCodeLine{00362\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{scheduler_8hpp_af6136b721c9ebd2c70157f07e7061f96}{SendTLM}}();}
\DoxyCodeLine{00363\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a9fbe58c903893e4dc56d5ded1cb0bfd4}{tlm\_t0}}\ =\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}};}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}tlm\_t0"{}},\ \mbox{\hyperlink{structplanner}{planner}}.\mbox{\hyperlink{structplanner_a9fbe58c903893e4dc56d5ded1cb0bfd4}{tlm\_t0}});}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \ \ \mbox{\hyperlink{update_8cpp_a965861de1a367ef4c2b467de34de2683}{mqtt\_client}}.loop();}
\DoxyCodeLine{00366\ \ \ \ \ \}}
\DoxyCodeLine{00367\ }
\DoxyCodeLine{00368\ \}}
\DoxyCodeLine{00369\ }
\DoxyCodeLine{00375\ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{scheduler_8hpp_af44cadcb682d8c434f4c30a70cd62aa9}{SchedulerClearAll}}(\textcolor{keywordtype}{int}\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}})\{}
\DoxyCodeLine{00376\ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}ota\_t0"{}},\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}});}
\DoxyCodeLine{00377\ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}tlm\_t0"{}},\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}});}
\DoxyCodeLine{00378\ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}analog\_t0"{}},\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}});}
\DoxyCodeLine{00379\ \ \ \ \ \mbox{\hyperlink{src_2main_8cpp_add9553c173198049d23f8a89fe11142c}{gator\_prefs}}.putInt(\textcolor{stringliteral}{"{}ht\_t0"{}},\ \mbox{\hyperlink{scheduler_8hpp_a2df27a00b191de3537c3b53adcecf1e8}{reset\_count}});}
\DoxyCodeLine{00380\ \}}
\DoxyCodeLine{00381\ }
\DoxyCodeLine{00382\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
